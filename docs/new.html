<!DOCTYPE html>
<html>
  <head>
    <title>Schoolbox API Reference</title>
    <!-- needed for adaptive design -->
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700" rel="stylesheet">
    <link rel="icon" type="image/png" href="./favicon.png">
    <script type="module" src="https://unpkg.com/rapidoc@9.2.0/dist/rapidoc-min.js"></script>
    <script type="text/javascript">
      if ('http:' === window.location.protocol && '?debug' !== window.location.search) {
        window.location.protocol = 'https:';
      }
      document.addEventListener('DOMContentLoaded', async function () {
        // Load content of builds.json
        let response = await fetch('/builds.json'),
            responseJson = await response.json(),
            selectedVersion = null;

        // Add each version to the picker
        const selector = document.getElementById('version-selector');
        responseJson.forEach(function (v) {
          let node = document.createElement('option');
          node.label = v.label;
          node.value = '/builds/' + v.value + '.yaml';
          node.innerText = v.label;
          selector.appendChild(node);

          // If nothing is selected: select first available version for now
          if (v.selected ?? false) {
            selectedVersion = node.value;
          } else {
            selectedVersion ??= node.value;
          }
        });

        // Set the current loaded version into the doc
        const rapidoc = document.getElementById('rapidoc');
        rapidoc.setAttribute('spec-url', selectedVersion);
        selector.value = selectedVersion;
        selector.addEventListener('change', ev => rapidoc.setAttribute('spec-url', ev.target.value));
      }, false);
    </script>
  </head>
  <body>
  <rapi-doc
          id="rapidoc"
          schema-style="table"
          show-header="false"
          schema-description-expanded="true"
  >
    <img slot="nav-logo" src="/logo.png" />
    <div slot="nav-logo" style="padding: revert">
      <div style="display: flex;justify-content: center;">
        <div>SB Version:</div>
        <select id="version-selector">
        </select>
      </div>
    </div>
  </rapi-doc>
  </body>
</html>
